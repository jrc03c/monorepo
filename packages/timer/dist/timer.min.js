(()=>{var o=class{duration=-1;name="Untitled timer event";start=new Date;timer=null;constructor(t){t=t||{},this.duration=t.duration||this.duration,this.name=t.name||this.name,this.start=t.start||this.start,this.timer=t.timer||this.timer,typeof this.start=="number"&&(this.start=new Date(this.start))}stop(){return this.timer?this.timer.stop(this):this.duration=new Date-this.start,this}toObject(){let t=this.start.getTime();return{duration:this.duration,name:this.name,start:t,stop:t+this.duration}}};var i=class{events=[];shouldLogToConsole=!0;constructor(t){t=t||{},this.events=t.events?t.events.map(s=>new o(s)):this.events,this.shouldLogToConsole=typeof t.shouldLogToConsole>"u"?this.shouldLogToConsole:t.shouldLogToConsole}get totalTime(){let t=this.events[0],s=this.events[0];return this.events.forEach(e=>{e.start<t.start&&(t=e),e.start+e.duration>s.start+s.duration&&(s=e)}),s.start+s.duration-t.start}start(t){let s=new Date,e=new o({name:t,start:s,timer:this});return this.shouldLogToConsole&&console.log(`${s.toLocaleString()} | START: ${t}`),this.events.push(e),e}stop(t){if(t=t instanceof o?t:this.events.find(s=>s.name===t&&s.timer===this),!t)throw new Error(`No running event with name "${t}" could be found!`);return t.timer=null,t.stop(),this.shouldLogToConsole&&console.log(`${new Date().toLocaleString()} | STOP: ${t.name} (duration: ${t.duration} ms)`),this}stopAll(){for(let t of this.events)t.timer===this&&this.stop(t);return this}toObject(){return{events:this.events.map(t=>t.toObject()),shouldLogToConsole:this.shouldLogToConsole}}};var a=class r extends i{static DEFAULT_LOCAL_STORAGE_KEY="timer";static fromLocalStorage(t){t=t||this.DEFAULT_LOCAL_STORAGE_KEY;let s=localStorage.getItem(t);if(!s)throw new Error(`No timer was saved under the \`localStorage\` key "${t}"!`);let e=JSON.parse(s);return new r(e)}static async fromURL(t){let s=await fetch(t),e=await s.text();if(s.status===200){let n=JSON.parse(e);return new r(n)}else throw new Error(`Non-200 status: "${e}"`)}localStorageKey=r.DEFAULT_LOCAL_STORAGE_KEY;shouldSaveToLocalStorage=!0;constructor(t){t=t||{},super(t),this.localStorageKey=t.localStorageKey||this.localStorageKey,this.shouldSaveToLocalStorage=typeof t.shouldSaveToLocalStorage>"u"?this.shouldSaveToLocalStorage:t.shouldSaveToLocalStorage}download(t){t=t||"timer-events.json";let s=document.createElement("a");return s.href="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.toObject(),null,2)),s.download=t,s.dispatchEvent(new MouseEvent("click")),this}save(){return this.shouldSaveToLocalStorage&&localStorage.setItem(this.localStorageKey,JSON.stringify(this.toObject(),null,2)),this}start(){let t=super.start(...arguments);return this.save(),t}stop(){let t=super.stop(...arguments);return this.save(),t}};typeof globalThis<"u"&&(globalThis.BrowserTimer=a,globalThis.Timer=a);})();
