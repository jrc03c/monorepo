(()=>{var s=class{duration=-1;name="Untitled timer event";start=new Date;timer=null;constructor(t){t=t||{},this.duration=t.duration||this.duration,this.name=t.name||this.name,this.start=t.start||this.start,this.timer=t.timer||this.timer,typeof this.start=="number"&&(this.start=new Date(this.start))}stop(){return this.timer?this.timer.stop(this):this.duration=new Date-this.start,this}toObject(){let t=this.start.getTime();return{duration:this.duration,name:this.name,start:t,stop:t+this.duration}}};var n=class{events=[];shouldLogToConsole=!0;constructor(t){t=t||{},this.events=t.events?t.events.map(e=>new s(e)):this.events,this.shouldLogToConsole=typeof t.shouldLogToConsole>"u"?this.shouldLogToConsole:t.shouldLogToConsole}get totalTime(){let t=1/0,e=-1/0;return this.events.forEach(o=>{if(o.timer===this)return;let a=o.start.getTime(),l=a+o.duration;a<t&&(t=a),l>e&&(e=l)}),e-t}start(t){let e=new Date,o=new s({name:t,start:e,timer:this});return this.shouldLogToConsole&&console.log(`${e.toLocaleString()} | START: ${t}`),this.events.push(o),o}stop(t){if(t=t instanceof s?t:this.events.find(e=>e.name===t&&e.timer===this),!t)throw new Error(`No running event with name "${t}" could be found!`);return t.timer=null,t.stop(),this.shouldLogToConsole&&console.log(`${new Date().toLocaleString()} | STOP: ${t.name} (duration: ${t.duration} ms)`),this}stopAll(){for(let t of this.events)t.timer===this&&this.stop(t);return this}toObject(){return{events:this.events.map(t=>t.toObject()),shouldLogToConsole:this.shouldLogToConsole}}};var i=class r extends n{static DEFAULT_LOCAL_STORAGE_KEY="timer";static fromLocalStorage(t){t=t||this.DEFAULT_LOCAL_STORAGE_KEY;let e=localStorage.getItem(t);if(!e)throw new Error(`No timer was saved under the \`localStorage\` key "${t}"!`);let o=JSON.parse(e);return new r(o)}static async fromURL(t){let e=await fetch(t),o=await e.text();if(e.status===200){let a=JSON.parse(o);return new r(a)}else throw new Error(`Non-200 status: "${o}"`)}localStorageKey=r.DEFAULT_LOCAL_STORAGE_KEY;shouldSaveToLocalStorage=!0;constructor(t){t=t||{},super(t),this.localStorageKey=t.localStorageKey||this.localStorageKey,this.shouldSaveToLocalStorage=typeof t.shouldSaveToLocalStorage>"u"?this.shouldSaveToLocalStorage:t.shouldSaveToLocalStorage}download(t){t=t||"timer-events.json";let e=document.createElement("a");return e.href="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.toObject(),null,2)),e.download=t,e.dispatchEvent(new MouseEvent("click")),this}save(){return this.shouldSaveToLocalStorage&&localStorage.setItem(this.localStorageKey,JSON.stringify(this.toObject(),null,2)),this}start(){let t=super.start(...arguments);return this.save(),t}stop(){let t=super.stop(...arguments);return this.save(),t}toObject(){return{...super.toObject(),localStorageKey:this.localStorageKey,shouldSaveToLocalStorage:this.shouldSaveToLocalStorage}}};typeof globalThis<"u"&&(globalThis.BrowserTimer=i,globalThis.Timer=i);})();
